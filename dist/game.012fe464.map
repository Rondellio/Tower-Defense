{"version":3,"sources":["js/CST.js","js/scenes/MenuScene.js","js/scenes/GameScene.js","js/scenes/LoadScene.js","js/game.js"],"names":["CST","SCENES","LOAD","MENU","GAME","MenuScene","key","data","console","log","add","image","setOrigin","setDepth","newGame","game","renderer","width","height","setInteractive","on","scene","start","Phaser","Scene","path","TOWER_GROUP","ENEMY_GROUP","ATTACKS_GROUP","THIS_SCENE","ENEMY_SPEED","ENEMY_HP","ENEMY_SPAWN_RATE","ATTACK_DAMAGE","TOWER_FIRE_RATE","peasantStats","towerId","towerName","upgrade","str","atkRange","atkType","atkRate","hitfly","soldierStats","archerStats","apprenticeStats","knightStats","duelistStats","riflemanStats","rangerStats","wizardStats","sorceressStats","commanderStats","paladinStats","swordmasterStats","cutpurseStats","cannoneerStats","sharpshooterStats","beastmasterStats","assassinStats","firemageStats","icemageStats","lightningmageStats","warlockStats","priestessStats","towerArr","map","buildMap","graphics","drawLines","lineTo","lineStyle","draw","background","sound","volume","loop","nextEnemy","physics","overlap","damageEnemy","input","mouse","disableContextMenu","userAction","pointer","i","Math","floor","y","j","x","leftButtonDown","newTower","get","placeTower","currTower","upgradeTower","rightButtonDown","tower","removeTower","getEnemy","distance","enemyUnits","getChildren","length","active","Distance","Between","enemy","attack","setActive","setVisible","receiveDamage","moveTo","strokePath","addAttack","angle","fire","Enemy","follower","t","vec","Vector2","hp","turned","healthbar","HealthBar","getPoint","setPosition","damage","decrease","play","destroy","death","time","delta","anims","GameObjects","Sprite","Deathknight","stats","call","create","frames","generateFrameNames","prefix","end","frameRate","repeat","Tower","nextTic","hitFly","text","font","fill","upgradeSound","remove","Angle","Peasant","Image","Soldier","bar","Graphics","value","p","existing","amount","clear","fillStyle","fillRect","d","Attack","incX","incY","lifespan","speed","GetSpeed","dx","cos","dy","sin","GameScene","group","classType","eval","runChildUpdate","startOnPath","LoadScene","load","atlas","spritesheet","frameWidth","frameHeight","audio","config","type","AUTO","parent","default","render","pixelArt","Game","mainGame","ATTACK_GROUP","setPadding","setText","Archer","preload","middleButtonDown"],"mappings":"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","file":"game.012fe464.map","sourceRoot":"..","sourcesContent":["export const CST = {\r\n    SCENES: {\r\n        LOAD: \"LOAD\",\r\n        MENU: \"MENU\",\r\n        GAME: \"GAME\"\r\n    }\r\n}\r\n","import { CST} from \"../CST\";\r\n\r\nexport class MenuScene extends Phaser.Scene{\r\n    constructor(){\r\n        super({\r\n            key: CST.SCENES.MENU\r\n        })\r\n    }\r\n    init(data){\r\n        console.log(data);\r\n    }\r\n   /* preload(){\r\n        this.load.image('menuscreen', 'assets/bg.png', { frameWidth: 640, frameHeight: 512 });\r\n        this.load.image('newgame', 'assets/new.png');\r\n    }*/\r\n    create(){\r\n        //Creating menu screen background layers\r\n        this.add.image(0, 0, 'menuscreen').setOrigin(0).setDepth(0);\r\n        let newGame = this.add.image(this.game.renderer.width / 2, this.game.renderer.height / 2, 'newgame').setDepth(1);\r\n        console.log(\"In Menu Scene\");\r\n\r\n        newGame.setInteractive();\r\n        newGame.on(\"pointerdown\", ()=>{\r\n            this.scene.start(CST.SCENES.GAME, \"Starting New Game\");\r\n        })\r\n    }\r\n}\r\n","import {CST} from \"../CST\";\r\n//import {Enemy} from \"../Enemy\";\r\n//import {GlobalVariables} from \"../GlobalVariables\";\r\n\r\n//--------------------------------------------------GLOBAL VARIABLES-------------------------------------------\r\nvar path;\r\nvar TOWER_GROUP = [];\r\nvar ENEMY_GROUP;\r\nvar ATTACKS_GROUP;\r\nvar THIS_SCENE;\r\n\r\nvar ENEMY_SPEED = 1/10000;\r\n//var ENEMY_SPEED = 1/Math.floor((Math.random() * 10000) + 10000);\r\nvar ENEMY_HP = 1000;\r\nvar ENEMY_SPAWN_RATE = 2000;\r\n//var ENEMY_SPAWN_RATE = Math.floor((Math.random() * 1000) + 1000);\r\nvar ATTACK_DAMAGE = 50;\r\nvar TOWER_FIRE_RATE = 300;\r\n\r\n//stats for each tower type loaded from file rather than defined here, but for now do this\r\n//objects to hold sounds and animation information as well?\r\nvar peasantStats = \t\t {towerId:0,  towerName:\"Peasant\", \t\t upgrade:true,  str:5,  atkRange:\"short\",     atkType:\"physical\", atkRate:\"slow\", \t  hitfly:false};\r\nvar soldierStats = \t\t {towerId:1,  towerName:\"Soldier\", \t\t upgrade:true,  str:10, atkRange:\"short\",     atkType:\"physical\", atkRate:\"medium\",   hitfly:false};\r\nvar archerStats = \t\t {towerId:2,  towerName:\"Archer\", \t\t upgrade:true,  str:8,  atkRange:\"medium\",    atkType:\"physical\", atkRate:\"slow\", \t  hitfly:true};\r\nvar apprenticeStats = \t {towerId:3,  towerName:\"Apprentice\", \t upgrade:true,  str:7,  atkRange:\"medium\",    atkType:\"magical\",  atkRate:\"medium\",   hitfly:false};\r\nvar knightStats = \t\t {towerId:4,  towerName:\"Knight\", \t\t upgrade:true,  str:15, atkRange:\"short\",     atkType:\"physical\", atkRate:\"medium\",   hitfly:false};\r\nvar duelistStats = \t\t {towerId:5,  towerName:\"Duelist\", \t\t upgrade:true,  str:12, atkRange:\"short\",     atkType:\"physical\", atkRate:\"fast\", \t  hitfly:false};\r\nvar riflemanStats =\t \t {towerId:6,  towerName:\"Rifleman\", \t upgrade:true,  str:20, atkRange:\"medium\",    atkType:\"physical\", atkRate:\"slow\", \t  hitfly:true};\r\nvar rangerStats = \t\t {towerId:7,  towerName:\"Ranger\", \t\t upgrade:true,  str:14, atkRange:\"medium\",    atkType:\"physical\", atkRate:\"medium\",   hitfly:true};\r\nvar wizardStats = \t\t {towerId:8,  towerName:\"Wizard\", \t\t upgrade:true,  str:10, atkRange:\"medium\", \t  atkType:\"magical\",  atkRate:\"medium\",   hitfly:true};\r\nvar sorceressStats = \t {towerId:9,  towerName:\"Sorceress\", \t upgrade:true,  str:13, atkRange:\"medium\", \t  atkType:\"magical\",  atkRate:\"slow\", \t  hitfly:true};\r\nvar commanderStats = \t {towerId:10, towerName:\"Commander\", \t upgrade:false, str:25, atkRange:\"short\", \t  atkType:\"physical\", atkRate:\"slow\", \t  hitfly:false};\r\nvar paladinStats = \t\t {towerId:11, towerName:\"Paladin\", \t\t upgrade:false, str:17, atkRange:\"short\", \t  atkType:\"physical\", atkRate:\"medium\",   hitfly:true};\r\nvar swordmasterStats = \t {towerId:12, towerName:\"Swordmaster\", \t upgrade:false, str:14, atkRange:\"short\", \t  atkType:\"physical\", atkRate:\"fast\", \t  hitfly:false};\r\nvar cutpurseStats = \t {towerId:13, towerName:\"Cutpurse\", \t upgrade:false, str:6,  atkRange:\"veryshort\", atkType:\"physical\", atkRate:\"veryfast\", hitfly:false};\r\nvar cannoneerStats = \t {towerId:14, towerName:\"Cannoneer\", \t upgrade:false, str:30, atkRange:\"long\", \t  atkType:\"physical\", atkRate:\"veryslow\", hitfly:false};\r\nvar sharpshooterStats =  {towerId:15, towerName:\"Sharpshooter\",  upgrade:false, str:35, atkRange:\"verylong\",  atkType:\"physical\", atkRate:\"slow\", \t  hitfly:true};\r\nvar beastmasterStats =   {towerId:16, towerName:\"Beastmaster\", \t upgrade:false, str:20, atkRange:\"long\",      atkType:\"physical\", atkRate:\"medium\",   hitfly:true};\r\nvar assassinStats = \t {towerId:17, towerName:\"Assassin\", \t upgrade:false, str:18, atkRange:\"long\",      atkType:\"physical\", atkRate:\"fast\", \t  hitfly:true};\r\nvar firemageStats = \t {towerId:18, towerName:\"FireMage\", \t upgrade:false, str:20, atkRange:\"medium\",    atkType:\"magical\",  atkRate:\"fast\", \t  hitfly:true};\r\nvar icemageStats = \t\t {towerId:19, towerName:\"IceMage\", \t\t upgrade:false, str:10, atkRange:\"long\",      atkType:\"magical\",  atkRate:\"medium\",   hitfly:true};\r\nvar lightningmageStats = {towerId:20, towerName:\"LightningMage\", upgrade:false, str:22, atkRange:\"short\",     atkType:\"magical\",  atkRate:\"medium\",   hitfly:true};\r\nvar warlockStats = \t\t {towerId:21, towerName:\"Warlock\", \t\t upgrade:false, str:15, atkRange:\"long\",      atkType:\"magical\",  atkRate:\"slow\", \t  hitfly:true};\r\nvar priestessStats =     {towerId:22, towerName:\"Priestess\", \t upgrade:false, str:13, atkRange:\"medium\",    atkType:\"magical\",  atkRate:\"medium\",   hitfly:true};\r\n\r\nvar towerArr = [peasantStats, \r\n\t\t\tsoldierStats, \r\n\t\t\tarcherStats, \r\n\t\t\tapprenticeStats, \r\n\t\t\tknightStats, \r\n\t\t\tduelistStats, \r\n\t\t\triflemanStats, \r\n\t\t\trangerStats,\r\n\t\t\twizardStats,\r\n\t\t\tsorceressStats,\r\n\t\t\tcommanderStats,\r\n\t\t\tpaladinStats,\r\n\t\t\tswordmasterStats,\r\n\t\t\tcutpurseStats,\r\n\t\t\tcannoneerStats,\r\n\t\t\tsharpshooterStats,\r\n\t\t\tbeastmasterStats,\r\n\t\t\tassassinStats,\r\n\t\t\tfiremageStats,\r\n\t\t\ticemageStats,\r\n\t\t\tlightningmageStats,\r\n\t\t\twarlockStats,\r\n\t\t\tpriestessStats];\r\n\r\n//map for tower placement, 0=can place, -1=cannot place, towerObj=tower already occupying space\r\nvar map =  [[ 0,-1, 0,-1,-1,-1,-1,-1,-1,-1],\r\n            [ 0,-1, 0, 0, 0, 0, 0, 0, 0,-1],\r\n            [ 0,-1,-1,-1,-1,-1,-1,-1, 0,-1],\r\n            [ 0, 0, 0, 0, 0, 0, 0,-1, 0,-1],\r\n            [-1,-1,-1,-1,-1,-1, 0,-1, 0,-1],\r\n            [-1,-1,-1,-1,-1,-1, 0,-1, 0,-1],\r\n            [-1,-1,-1,-1,-1,-1, 0,-1, 0,-1],\r\n            [-1,-1,-1,-1,-1,-1, 0,-1, 0,-1]];\r\n\t\t\t\r\n\r\n//------------------------------------------FUNCTIONS---------------------------------------------------\t\t\t\r\n//build the pathing and map for level\r\nfunction buildMap(){\r\n\t//path to which enemey follows\r\n    var graphics = THIS_SCENE.add.graphics();    \r\n    drawLines(graphics);\r\n    path = THIS_SCENE.add.path(96, -32);\r\n    path.lineTo(96, 164);\r\n    path.lineTo(480, 164);\r\n    path.lineTo(480, 544);\r\n    graphics.lineStyle(0, 0xffffff, 1);\r\n    path.draw(graphics);\r\n    \r\n\t//add map image\r\n\tTHIS_SCENE.add.image(320, 256, 'map');\r\n\t\r\n\t//add background music\r\n\tvar background = THIS_SCENE.sound.add('background');\r\n\tbackground.volume = 0.04;\r\n\tbackground.loop = true;\r\n\t//background.play();\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//sounds\r\n\t\r\n\tTHIS_SCENE.nextEnemy = 0;\r\n\tTHIS_SCENE.physics.add.overlap(ENEMY_GROUP, ATTACKS_GROUP, damageEnemy);\r\n    THIS_SCENE.input.mouse.disableContextMenu();\r\n}\r\n\r\n//user input related actions \r\nfunction userAction(pointer){\r\n\tvar i = Math.floor(pointer.y/64);\r\n\tvar j = Math.floor(pointer.x/64);\r\n\tif (pointer.leftButtonDown())\r\n        {\r\n\t\t\t//if new tower\r\n\t\t\tif(map[i][j] == 0)\r\n\t\t\t{\r\n\t\t\t\tvar newTower = TOWER_GROUP[peasantStats.towerId].get(peasantStats);\r\n\t\t\t\tnewTower.placeTower(pointer);\r\n\t\t\t}\r\n\t\t\t//if upgrade tower\r\n\t\t\telse if(typeof map[i][j] === \"object\")\r\n\t\t\t{\r\n\t\t\t\tvar currTower = map[i][j];\r\n\t\t\t\tvar newTower = TOWER_GROUP[soldierStats.towerId].get(soldierStats);\r\n\t\t\t\tcurrTower.upgradeTower(pointer, newTower);\r\n\t\t\t}\r\n        }\r\n        else if (pointer.rightButtonDown())\r\n        {\r\n\t\t\tvar tower = map[i][j];\r\n\t\t\tif(typeof tower === \"object\")\r\n\t\t\t{\r\n\t\t\t\ttower.removeTower(pointer);\r\n\t\t\t}\r\n\r\n        }\r\n}\r\n\r\nfunction getEnemy(x, y, distance) {\r\n    var enemyUnits = ENEMY_GROUP.getChildren();\r\n    for(var i = 0; i < enemyUnits.length; i++) {       \r\n        if(enemyUnits[i].active && Phaser.Math.Distance.Between(x, y, enemyUnits[i].x, enemyUnits[i].y) < distance)\r\n            return enemyUnits[i];\r\n    }\r\n    return false;\r\n} \r\n\r\nfunction damageEnemy(enemy, attack) {  \r\n    // only if both enemy and attack are alive\r\n    if (enemy.active === true && attack.active === true) {\r\n        // we remove the attack right away\r\n        attack.setActive(false);\r\n        attack.setVisible(false);    \r\n        \r\n        // decrease the enemy hp with ATTACK_DAMAGE\r\n        enemy.receiveDamage(ATTACK_DAMAGE);\r\n        //damage.play();\r\n    }\r\n}\r\n\r\nfunction drawLines(graphics) {\r\n    graphics.lineStyle(1, 0x0000ff, 0.8);\r\n    for(var i = 0; i < 8; i++) {\r\n        graphics.moveTo(0, i * 64);\r\n        graphics.lineTo(640, i * 64);\r\n    }\r\n    for(var j = 0; j < 10; j++) {\r\n        graphics.moveTo(j * 64, 0);\r\n        graphics.lineTo(j * 64, 512);\r\n    }\r\n    graphics.strokePath();\r\n}\t\r\n\r\nfunction addAttack(x, y, angle) {\r\n    var attack = ATTACKS_GROUP.get();\r\n    if (attack)\r\n    {\r\n        attack.fire(x, y, angle);\r\n    }\r\n}\r\n\r\n//---------------------------------------------------------CLASSES--------------------------------------------\r\n//enemy class\r\nclass Enemy extends Phaser.GameObjects.Sprite {\r\n\r\n    constructor (scene)\r\n    {\r\n        super(scene);\r\n        //dknight.animations.add('walk_down', 1, 4);\r\n        //this.anims.create({ key: 'down', frames: this.anims.generateFrameNames('deathknight', { prefix: 'walk_down_', start: 1, end: 4 }), frameRate: 5, repeat: -1 })\r\n\t\t//var enemy = Phaser.GameObjects.Sprite.call(this, scene, 0, 0, 'deathknight');\r\n\r\n        this.follower = { t: 0, vec: new Phaser.Math.Vector2() };\r\n        this.hp = 0;\r\n        this.turned = 0;\r\n\t\t\r\n\t\t//this.text = THIS_SCENE.add.text(0, 0, \"HP: \"+ ENEMY_HP, {font: \"16px Arial\", fill: \"#ffffff\"});\r\n\t\t//this.text.setPadding(0, 0, 0, 60);\r\n\t\t//this.text.setOrigin(0.5);\r\n\t\tthis.healthbar = new HealthBar(scene, 0, 0);\r\n\t\t\r\n    }\r\n\r\n\tstartOnPath ()\r\n\t{\r\n\t\tthis.follower.t = 0;\r\n\t\tthis.hp = ENEMY_HP;\r\n\t\t\r\n\t\t//this.walk.play();\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//sounds\r\n\t\t\r\n\t\tpath.getPoint(this.follower.t, this.follower.vec);\r\n\t\t\r\n\t\tthis.setPosition(this.follower.vec.x, this.follower.vec.y);\r\n\t\t\r\n\t\t//this.text.setPosition(this.follower.vec.x, this.follower.vec.y);\r\n\t\tthis.healthbar.setPosition(this.follower.vec.x - this.width, this.follower.vec.y - this.height);\r\n\t }\r\n\t\r\n\treceiveDamage(damage) {\r\n\t\tthis.hp -= damage;           \r\n\t\t//this.text.setText(\"HP: \" + this.hp);\r\n\t\tthis.healthbar.decrease(damage);\r\n\t\tthis.damage.play();\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//sounds\r\n\t\t\r\n\t\t// if hp drops below 0 we deactivate this enemy\r\n\t\tif (this.hp <= 0) {\r\n\t\t\tthis.setActive(false);\r\n\t\t\tthis.setVisible(false);\r\n\t\t\t//this.text.setActive(false);\r\n\t\t\t//this.text.setVisible(false);\r\n\t\t\tthis.healthbar.destroy();\r\n\t\t\t\r\n\t\t\t//Need to set this to stop when all enemies are dead\r\n\t\t\tthis.death.play();\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//sounds\r\n\t\t\t//this.walk.stop();\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//sounds\r\n\t\t\tthis.destroy();\r\n\t\t}\r\n\t}\r\n\t\r\n\tupdate (time, delta)\r\n\t{\r\n\t\t//ENEMY_SPEED = 1/Math.floor((Math.random() * (10000 - 5000)) + 5000);\r\n\t\tthis.follower.t += ENEMY_SPEED * delta;\r\n\t\t\r\n\t\tpath.getPoint(this.follower.t, this.follower.vec);\r\n\t\t\r\n\t\tthis.setPosition(this.follower.vec.x, this.follower.vec.y);\r\n\t\t//this.text.setPosition(this.follower.vec.x, this.follower.vec.y);\r\n\t\tthis.healthbar.setPosition(this.follower.vec.x - this.width, this.follower.vec.y - this.height);\r\n\t\t\r\n\t\tif (this.follower.vec.y == 164 && this.turned == 0) {\r\n\t\t\tthis.anims.play('dkright');\r\n\t\t\tthis.turned = 1;\r\n\t\t}\r\n\t\telse if (this.follower.vec.y != 164 && this.turned == 1)\r\n\t\t{\r\n\t\t\tthis.anims.play('dkdown');\r\n\t\t\tthis.turned = 2;\r\n\t\t}\r\n\r\n\t\tif (this.follower.t >= 1)\r\n\t\t{\r\n\t\t\tthis.setActive(false);\r\n\t\t\tthis.setVisible(false);\r\n\t\t\t//this.text.setActive(false);\r\n\t\t\t//this.text.setVisible(false);\r\n\t\t\tthis.healthbar.destroy();\r\n\t\t\t//this.walk.stop();\t\t\t\t\t\t\t\t\t\t\t\t//sounds\r\n\t\t\tthis.destroy();\r\n\t\t}\r\n\t}\r\n};\r\n\r\nclass Deathknight extends Enemy {\r\n\tconstructor(scene, stats) {\r\n\t\tsuper(scene);\r\n\t\tPhaser.GameObjects.Sprite.call(this, scene, 0, 0, 'deathknight');\r\n\t\t\r\n\t\t//create animations\r\n\t\tTHIS_SCENE.anims.create({\r\n\t\t\tkey: 'dkdown',\r\n\t\t\tframes: THIS_SCENE.anims.generateFrameNames('deathknight', { prefix: 'walk_down_', start: 1, end: 4 }),\r\n\t\t\tframeRate: 3,\r\n\t\t\trepeat: -1\r\n\t\t});\r\n\t\tTHIS_SCENE.anims.create({\r\n\t\t\tkey: 'dkright',\r\n\t\t\tframes: THIS_SCENE.anims.generateFrameNames('deathknight', { prefix: 'walk_right_', start: 1, end: 4 }),\r\n\t\t\tframeRate: 5,\r\n\t\t\trepeat: -1\r\n\t\t});\r\n        this.anims.play('dkdown');\r\n\t\t\r\n\t\t//create sounds\r\n\t\tthis.death = THIS_SCENE.sound.add('dkDeath');\r\n\t\tthis.death.volume = 0.05;\r\n\t\tthis.death.loop = false;\r\n\t\t\r\n\t\tthis.damage = THIS_SCENE.sound.add('hit');\r\n\t\tthis.damage.volume = 0.03;\r\n\t\tthis.damage.loop = false;\r\n\t\t\r\n\t\t/* this.walk = THIS_SCENE.sound.add('walk');\r\n\t\tthis.walk.volume = 0.01;\r\n\t\tthis.walk.loop = true; */\r\n\t}\r\n\tpFn()\r\n\t{\r\n\t\tconsole.log(this.towerName);\r\n\t}\r\n\r\n}\r\n\r\n//tower class\r\nclass Tower extends Phaser.GameObjects.Sprite{\r\n\r\n\tconstructor (scene, stats)\r\n\t{\r\n\t\tsuper(scene);\r\n\r\n\t\tthis.nextTic = 0;\r\n\t\tthis.towerId =  stats.towerId; //each tower has unique id\r\n\t\tthis.towerName = stats.towerName;\r\n\t\tthis.upgrade = stats.upgrade; //true = can upgrade, false = can't upgrade\r\n\t\tthis.str = stats.str; //value tha determines attack strength\r\n\t\tthis.atkRange = stats.atkRange;\r\n\t\tthis.atkType = stats.atkType;\r\n\t\tthis.atkRate = stats.atkRate; \r\n\t\tthis.hitFly = stats.hitFly; //true = can hit flying enemeies, false = cannot hit flying enemies\r\n\t\t//this.aoeRange = aoeRange; //area of effect range\r\n\t\t//this.spc = spc; //has special attack, each value represents special type, 0 = none, 1 = chance to stun, etc.\r\n\t\t\r\n\t\tthis.text = THIS_SCENE.add.text(0, 0, this.towerName, {font: \"16px Arial\", fill: \"#ffffff\"});\r\n\t\t\r\n\t\tthis.upgradeSound = THIS_SCENE.sound.add('upgradeSound');\r\n\t\tthis.upgradeSound.volume = 0.05;\r\n\t\tthis.upgradeSound.loop = false;\r\n\t\t\r\n\t}\r\n\t\r\n\tplaceTower(pointer) {\r\n\t\tvar i = Math.floor(pointer.y/64);\r\n\t\tvar j = Math.floor(pointer.x/64);\r\n\t\tif(map[i][j] === 0) {\r\n\t\t\t//console.log(tower);\r\n\t\t\tif (this)\r\n\t\t\t{\r\n\t\t\t\tthis.text.y = (i+.50) * 64 + 64/2;\r\n\t\t\t\tthis.text.x = j * 64 + 64/2;\r\n\t\t\t\tthis.text.setOrigin(0.5);\r\n\t\t\t\t//THIS_SCENE.add.container([this.text, this]);\r\n\t\t\t\tthis.setActive(true);\r\n\t\t\t\tthis.setVisible(true);\r\n\t\t\t\tthis.y = i * 64 + 64/2;\r\n\t\t\t\tthis.x = j * 64 + 64/2;\r\n\t\t\t\t//map[i][j] = 1;\r\n\t\t\t\tmap[i][j] = this;\r\n\t\t\t}   \r\n\t\t\t//console.log(TOWER_GROUP.getTotalUsed());\r\n\t\t\t//console.log(TOWER_GROUP.getLength());\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tTOWER_GROUP[this.towerId].remove(this, true, true);\t\t//tower is created before it's placed so removed if the place clicked on is  not avaialble\r\n\t\t}\r\n\t}\r\n\r\n\tremoveTower(pointer) {\r\n\t\tvar i = Math.floor(pointer.y/64);\r\n\t\tvar j = Math.floor(pointer.x/64);\r\n\t\tif(map[i][j] !== 0) {\r\n\t\t\tthis.setActive(false);\r\n\t\t\tthis.setVisible(false);\r\n\t\t\tthis.text.destroy();\r\n\t\t\tmap[i][j] = 0;\t\t\t\t\t\t\t\t\t\t\t\t//remove from map\r\n\t\t\tTOWER_GROUP[this.towerId].remove(this, true, true);\t\t\t//removes from group, if want to keep it as inactive then remove this line\r\n\t\t}\r\n\t\t\t\r\n\t}\r\n\t\r\n\tupgradeTower(pointer, newTower) {\r\n\t\t//check if tower is already upgraded, if not the upgrade\r\n\t\tif(this.towerName !== newTower.towerName)\r\n\t\t{\r\n\t\t\tvar i = Math.floor(pointer.y/64);\r\n\t\t\tvar j = Math.floor(pointer.x/64);\r\n\t\t\tthis.removeTower(pointer);\r\n\t\t\tnewTower.placeTower(pointer);\r\n\t\t\t//console.log(TOWER_GROUP.getTotalUsed());\r\n\t\t\t//console.log(TOWER_GROUP.getLength());\r\n\t\t\tthis.text = newTower.towerName;\r\n\t\t\tthis.upgradeSound.play();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tTOWER_GROUP[newTower.towerId].remove(newTower, true, true);\t\t//tower is created before it's placed so removed if the place clicked on is  not avaialble\r\n\t\t\tnewTower.text.destroy();\r\n\t\t}\r\n\t\r\n\t}\r\n\t\r\n\tfire() {\r\n\t\tvar enemy = getEnemy(this.x, this.y, 200);\r\n\t\tif(enemy) {\r\n\t\t\tvar angle = Phaser.Math.Angle.Between(this.x, this.y, enemy.x, enemy.y);\r\n\t\t\taddAttack(this.x, this.y, angle);\r\n\t\t\t//this.angle = (angle + Math.PI/2) * Phaser.Math.RAD_TO_DEG;    //uncomment to make towers rotate to face enemy\r\n\t\t}\r\n\t}\r\n\t\r\n\tupdate(time, delta, pointer)\r\n\t{\r\n\t\tif(time > this.nextTic) {\r\n\t\t\tthis.fire();\r\n\t\t\tthis.nextTic = time + TOWER_FIRE_RATE;\r\n\t\t}\r\n\t}\r\n\tsayName()\r\n\t{\r\n\t\tconsole.log(this.towerName);\r\n\t}\r\n\r\n};\r\n\r\nclass Peasant extends Tower {\r\n\tconstructor(scene, stats) {\r\n\t\t// Note: In derived classes, super() must be called before you\r\n\t\t// can use 'this'. Leaving this out will cause a reference error.\r\n\t\tsuper(scene, stats);\r\n\t\tPhaser.GameObjects.Image.call(this, scene, 0, 0, 'peasant', 'sprite35');\r\n\t}\r\n\tpFn()\r\n\t{\r\n\t\tconsole.log(this.towerName);\r\n\t}\r\n\r\n}\r\n\r\nclass Soldier extends Tower {\r\n\tconstructor(scene, stats) {\r\n\t\tsuper(scene, stats);\r\n\t\tPhaser.GameObjects.Image.call(this, scene, 0, 0, 'soldier', 'sprite25');\r\n\t\t\r\n\t}\r\n\tsFn()\r\n\t{\r\n\t\tconsole.log(this.towerName);\r\n\t}\r\n\r\n}\r\n\r\n//all other classes\r\n//HP class\r\nclass HealthBar {\r\n\r\n    constructor(scene, x, y) {\r\n        this.bar = new Phaser.GameObjects.Graphics(scene);\r\n\r\n        this.x = x;\r\n        this.y = y;\r\n        this.value = ENEMY_HP;\r\n        this.p = .076;\r\n\r\n        this.draw();\r\n\r\n        THIS_SCENE.add.existing(this.bar);\r\n    }\r\n\r\n    setPosition(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.draw();\r\n    }\r\n\r\n    decrease(amount) {\r\n        this.value -= amount;\r\n\r\n        if (this.value < 0) {\r\n            this.value = 0;\r\n        }\r\n\r\n        this.draw();\r\n\r\n        return (this.value === 0);\r\n    }\r\n\r\n    draw() {\r\n        this.bar.clear();\r\n\r\n        //  BG\r\n        this.bar.fillStyle(0x000000);\r\n        this.bar.fillRect(this.x, this.y, 80, 16);\r\n\r\n        //  Health\r\n\r\n        this.bar.fillStyle(0xffffff);\r\n        this.bar.fillRect(this.x + 2, this.y + 2, 76, 12);\r\n\r\n        if (this.value < 0.6 * ENEMY_HP) {\r\n            this.bar.fillStyle(0xff0000);\r\n        }\r\n        else if (this.value < 0.3 * ENEMY_HP)\r\n            this.bar.fillStyle(0x00ffff);\r\n        else {\r\n            this.bar.fillStyle(0x00ff00);\r\n        }\r\n\r\n        var d = Math.floor(this.p * this.value);\r\n\r\n        this.bar.fillRect(this.x + 2, this.y + 2, d, 12);\r\n    }\r\n\r\n    destroy() {\r\n        this.bar.destroy();\r\n    }\r\n\r\n}\r\n\r\n//the yellow thing the towers shoots at enemy, can be any form of projectile\r\nclass Attack extends Phaser.GameObjects.Image {\r\n\tconstructor(scene)\r\n\t{\r\n\t\tsuper(scene);\r\n\t\tPhaser.GameObjects.Image.call(this, scene, 0, 0, 'attack');\r\n\r\n\t\tthis.incX = 0;\r\n\t\tthis.incY = 0;\r\n\t\tthis.lifespan = 0;\r\n\r\n\t\tthis.speed = Phaser.Math.GetSpeed(600, 1);\r\n\t}\r\n\r\n\tfire(x, y, angle)\r\n\t{\r\n\t\tthis.setActive(true);\r\n\t\tthis.setVisible(true);\r\n\t\t//  Attacks fire from the middle of the screen to the given x/y\r\n\t\tthis.setPosition(x, y);\r\n\t\t\r\n\t//  we don't need to rotate the attacks as they are round\r\n\t//    this.setRotation(angle);\r\n\r\n\t\tthis.dx = Math.cos(angle);\r\n\t\tthis.dy = Math.sin(angle);\r\n\r\n\t\tthis.lifespan = 1000;\r\n\t}\r\n\r\n\tupdate (time, delta)\r\n\t{\r\n\t\tthis.lifespan -= delta;\r\n\r\n\t\tthis.x += this.dx * (this.speed * delta);\r\n\t\tthis.y += this.dy * (this.speed * delta);\r\n\r\n\t\tif (this.lifespan <= 0)\r\n\t\t{\r\n\t\t\tthis.setActive(false);\r\n\t\t\tthis.setVisible(false);\r\n\t\t}\r\n\t}\r\n\r\n};\r\n\r\n\r\nexport class GameScene extends Phaser.Scene {\r\n    constructor(){\r\n        super({\r\n            key: CST.SCENES.GAME\r\n        })\r\n    }\r\n\r\n    \r\n    //Preload function loads assets before game starts\r\n \r\n    init(data){\r\n        console.log(data);\r\n    }\r\n\r\n    //create function initializes and adds assets to game\r\n    create() {\r\n        //remove some ambiguity of what 'this' is. Can be used in classes without having to send as a parameter since it's now globabl\r\n\t\tTHIS_SCENE = this;\r\n\t\t\r\n\t\t/*creates a group for a tower type, that way we can use TOWER_GROUP.get(towerStats) to instantiate new towers easily\r\n\t\tloop through towerArr to get each tower object\r\n\t\tthen add each object to TOWER_GROUP arr\r\n\t\twe do this becuase TOWER_GROUP can now be easily used to manipulate tower objects with Phaser functions.*/\r\n\t\t//loop set to 2 since we only have 2 developed classes at the moment\r\n\t\tfor(var i = 0; i < 2; i++) {\r\n\t\t    TOWER_GROUP[towerArr[i].towerId] = this.add.group({ classType: eval(towerArr[i].towerName), runChildUpdate: true });\r\n\t\t}\r\n\t\t\r\n\t\t//enemy group will be a loop similar to tower group\r\n\t\tENEMY_GROUP = this.physics.add.group({ classType: Deathknight, runChildUpdate: true }); //key: 'walk_down_', frame: [1, 2, 3, 4], repeat: 5, active: true });\r\n\t\t\r\n\t\t//turned into attack group soon for different attack types\r\n\t\tATTACKS_GROUP = this.physics.add.group({ classType: Attack, runChildUpdate: true });\r\n\t\t\r\n\t\t//build the game map, this includes pathing, map image, background sounds, and general game assets\r\n\t\tbuildMap();\r\n\t\t\r\n\t\t//input related actions in userAction function\r\n\t\tthis.input.on('pointerdown', function (pointer){userAction(pointer)});\r\n\t\t/* this.input.on('gameobjectdown', function (pointer,gameObject){\r\n\t\t\tconsole.log(gameObject);\r\n\t\t}); */\r\n    }\r\n\r\n    //update function constantly refreshes so to progress game\r\n    update(time, delta, path) {  \r\n\r\n        if (time > this.nextEnemy)\r\n        {\r\n            var enemy = ENEMY_GROUP.get(path);\r\n            if (enemy)\r\n            {\r\n                enemy.setActive(true);\r\n                enemy.setVisible(true);\r\n                enemy.startOnPath();\r\n                //ENEMY_SPEED = 1/Math.floor((Math.random() * (2000 - 500)) + 500);\r\n                this.nextEnemy = time + ENEMY_SPAWN_RATE;\r\n            }       \r\n        }\r\n\t\r\n    }\r\n}\r\n","import { CST} from \"../CST\";\r\n\r\nexport class LoadScene extends Phaser.Scene{\r\n    constructor(){\r\n        super({\r\n            key: CST.SCENES.LOAD\r\n        })\r\n    }\r\n\r\n    preload(){\r\n        this.load.atlas('deathknight', './dist/assets/deathknight.png', './dist/assets/deathknight.json');\r\n        this.load.atlas('solider', './assets/solider.png', './dist/assets/solider.json');\r\n        this.load.atlas('peasant', './dist/assets/peasant.png', './dist/assets/peasant.json');\r\n        this.load.spritesheet('bard', './dist/assets/bard.png', { frameWidth: 52, frameHeight: 75});\r\n        this.load.image('attack', './dist/assets/coin.png');\r\n        this.load.image('map', './dist/assets/castle-gates.png', { frameWidth: 640, frameHeight: 512 });\r\n        this.load.audio('dkDeath', './dist/assets/Sounds/Death Screams/Human/sfx_deathscream_human5.wav');\r\n        this.load.audio('hit', './dist/assets/Sounds/General Sounds/Simple Damage Sounds/sfx_damage_hit2.wav');\r\n        this.load.audio('walk', './dist/assets/Sounds/Movement/Footsteps/sfx_movement_footstepsloop4_slow.wav');\r\n        this.load.audio('background', './dist/assets/Sounds/random silly chip song.ogg');\r\n\t\tthis.load.audio('upgradeSound', './dist/dist/assets/Sounds/General Sounds/Positive Sounds/sfx_sounds_powerup6.wav');\r\n        this.load.image('menuscreen', './dist/assets/bg.png', { frameWidth: 640, frameHeight: 512 });\r\n        this.load.image('newgame', './dist/assets/new.png');\r\n    }\r\n    create(){\r\n        //Creating menu screen background layers\r\n        this.scene.start(CST.SCENES.MENU, \"Loading complete\");\r\n        }\r\n}","import {MenuScene} from \"./scenes/MenuScene\";\r\nimport {GameScene} from \"./scenes/GameScene\";\r\nimport {LoadScene} from \"./scenes/LoadScene\";\r\n\r\n//-------------------------------------------------------SETUP-----------------------------------------------------\r\n//master config for game\r\n\r\nvar config = {\r\n    type: Phaser.AUTO,\r\n    parent: 'content',\r\n    width: 640,\r\n    height: 512,\r\n    physics: {\r\n        default: 'arcade'\r\n    },\r\n    render:{\r\n        pixelArt: true\r\n    },\r\n    scene: [\r\n        LoadScene,\r\n        MenuScene,\r\n        GameScene]\r\n    \r\n};\r\n\r\n//begin game\r\nvar game = new Phaser.Game(config);\r\n\r\n//--------------------------------------------------GLOBAL VARIABLES-------------------------------------------\r\nvar path;\r\nvar TOWER_GROUP = [];\r\nvar ENEMY_GROUP;\r\nvar mainGame;\r\n\r\nvar ENEMY_SPEED = 1/10000;\r\n//var ENEMY_SPEED = 1/Math.floor((Math.random() * 10000) + 10000);\r\nvar ENEMY_HP = 1000;\r\nvar ENEMY_SPAWN_RATE = 2000;\r\n//var ENEMY_SPAWN_RATE = Math.floor((Math.random() * 1000) + 1000);\r\nvar ATTACK_DAMAGE = 50;\r\nvar TOWER_FIRE_RATE = 300;\r\n\r\n//stats for each tower type loaded from file rather than defined here, but for now do this\r\nvar peasantStats = \t\t {towerId:0,  towerName:\"Peasant\", \t\t upgrade:true,  str:50,  atkRange:150,     atkType:\"physical\", atkRate:500, \t  hitfly:false};\r\nvar soldierStats = \t\t {towerId:1,  towerName:\"Soldier\", \t\t upgrade:true,  str:100, atkRange:200,     atkType:\"physical\", atkRate:400,   hitfly:false};\r\nvar archerStats = \t\t {towerId:2,  towerName:\"Archer\", \t\t upgrade:true,  str:120, atkRange:250,    atkType:\"physical\", atkRate:350, \t  hitfly:true};\r\nvar apprenticeStats = \t {towerId:3,  towerName:\"Apprentice\", \t upgrade:true,  str:7,  atkRange:\"medium\",    atkType:\"magical\",  atkRate:\"medium\",   hitfly:false};\r\nvar knightStats = \t\t {towerId:4,  towerName:\"Knight\", \t\t upgrade:true,  str:15, atkRange:\"short\",     atkType:\"physical\", atkRate:\"medium\",   hitfly:false};\r\nvar duelistStats = \t\t {towerId:5,  towerName:\"Duelist\", \t\t upgrade:true,  str:12, atkRange:\"short\",     atkType:\"physical\", atkRate:\"fast\", \t  hitfly:false};\r\nvar riflemanStats =\t \t {towerId:6,  towerName:\"Rifleman\", \t upgrade:true,  str:20, atkRange:\"medium\",    atkType:\"physical\", atkRate:\"slow\", \t  hitfly:true};\r\nvar rangerStats = \t\t {towerId:7,  towerName:\"Ranger\", \t\t upgrade:true,  str:14, atkRange:\"medium\",    atkType:\"physical\", atkRate:\"medium\",   hitfly:true};\r\nvar wizardStats = \t\t {towerId:8,  towerName:\"Wizard\", \t\t upgrade:true,  str:10, atkRange:\"medium\", \t  atkType:\"magical\",  atkRate:\"medium\",   hitfly:true};\r\nvar sorceressStats = \t {towerId:9,  towerName:\"Sorceress\", \t upgrade:true,  str:13, atkRange:\"medium\", \t  atkType:\"magical\",  atkRate:\"slow\", \t  hitfly:true};\r\nvar commanderStats = \t {towerId:10, towerName:\"Commander\", \t upgrade:false, str:25, atkRange:\"short\", \t  atkType:\"physical\", atkRate:\"slow\", \t  hitfly:false};\r\nvar paladinStats = \t\t {towerId:11, towerName:\"Paladin\", \t\t upgrade:false, str:17, atkRange:\"short\", \t  atkType:\"physical\", atkRate:\"medium\",   hitfly:true};\r\nvar swordmasterStats = \t {towerId:12, towerName:\"Swordmaster\", \t upgrade:false, str:14, atkRange:\"short\", \t  atkType:\"physical\", atkRate:\"fast\", \t  hitfly:false};\r\nvar cutpurseStats = \t {towerId:13, towerName:\"Cutpurse\", \t upgrade:false, str:6,  atkRange:\"veryshort\", atkType:\"physical\", atkRate:\"veryfast\", hitfly:false};\r\nvar cannoneerStats = \t {towerId:14, towerName:\"Cannoneer\", \t upgrade:false, str:30, atkRange:\"long\", \t  atkType:\"physical\", atkRate:\"veryslow\", hitfly:false};\r\nvar sharpshooterStats =  {towerId:15, towerName:\"Sharpshooter\",  upgrade:false, str:35, atkRange:\"verylong\",  atkType:\"physical\", atkRate:\"slow\", \t  hitfly:true};\r\nvar beastmasterStats =   {towerId:16, towerName:\"Beastmaster\", \t upgrade:false, str:20, atkRange:\"long\",      atkType:\"physical\", atkRate:\"medium\",   hitfly:true};\r\nvar assassinStats = \t {towerId:17, towerName:\"Assassin\", \t upgrade:false, str:18, atkRange:\"long\",      atkType:\"physical\", atkRate:\"fast\", \t  hitfly:true};\r\nvar firemageStats = \t {towerId:18, towerName:\"FireMage\", \t upgrade:false, str:20, atkRange:\"medium\",    atkType:\"magical\",  atkRate:\"fast\", \t  hitfly:true};\r\nvar icemageStats = \t\t {towerId:19, towerName:\"IceMage\", \t\t upgrade:false, str:10, atkRange:\"long\",      atkType:\"magical\",  atkRate:\"medium\",   hitfly:true};\r\nvar lightningmageStats = {towerId:20, towerName:\"LightningMage\", upgrade:false, str:22, atkRange:\"short\",     atkType:\"magical\",  atkRate:\"medium\",   hitfly:true};\r\nvar warlockStats = \t\t {towerId:21, towerName:\"Warlock\", \t\t upgrade:false, str:15, atkRange:\"long\",      atkType:\"magical\",  atkRate:\"slow\", \t  hitfly:true};\r\nvar priestessStats =     {towerId:22, towerName:\"Priestess\", \t upgrade:false, str:13, atkRange:\"medium\",    atkType:\"magical\",  atkRate:\"medium\",   hitfly:true};\r\n\r\n//map for tower placement, 0=can place, -1=cannot place, 1=can place with turrent already occupying space\r\nvar map =  [[ 0,-1, 0,-1,-1,-1,-1,-1,-1,-1],\r\n            [ 0,-1, 0, 0, 0, 0, 0, 0, 0,-1],\r\n            [ 0,-1,-1,-1,-1,-1,-1,-1, 0,-1],\r\n            [ 0, 0, 0, 0, 0, 0, 0,-1, 0,-1],\r\n            [-1,-1,-1,-1,-1,-1, 0,-1, 0,-1],\r\n            [-1,-1,-1,-1,-1,-1, 0,-1, 0,-1],\r\n            [-1,-1,-1,-1,-1,-1, 0,-1, 0,-1],\r\n            [-1,-1,-1,-1,-1,-1, 0,-1, 0,-1]];\r\n\t\t\t\r\n\r\n//------------------------------------------FUNCTIONS---------------------------------------------------\t\t\t\r\nfunction getEnemy(x, y, distance) {\r\n    var enemyUnits = ENEMY_GROUP.getChildren();\r\n    for(var i = 0; i < enemyUnits.length; i++) {       \r\n        if(enemyUnits[i].active && Phaser.Math.Distance.Between(x, y, enemyUnits[i].x, enemyUnits[i].y) < distance)\r\n            return enemyUnits[i];\r\n    }\r\n    return false;\r\n} \r\n\r\nfunction damageEnemy(enemy, attack) {  \r\n    // only if both enemy and attack are alive\r\n    if (enemy.active === true && attack.active === true) {\r\n        // we remove the attack right away\r\n        attack.setActive(false);\r\n        attack.setVisible(false);    \r\n        \r\n        // decrease the enemy hp with ATTACK_DAMAGE\r\n        enemy.receiveDamage(attack.damage);\r\n        //damage.play();\r\n    }\r\n}\r\n\r\nfunction drawLines(graphics) {\r\n    graphics.lineStyle(1, 0x0000ff, 0.8);\r\n    for(var i = 0; i < 8; i++) {\r\n        graphics.moveTo(0, i * 64);\r\n        graphics.lineTo(640, i * 64);\r\n    }\r\n    for(var j = 0; j < 10; j++) {\r\n        graphics.moveTo(j * 64, 0);\r\n        graphics.lineTo(j * 64, 512);\r\n    }\r\n    graphics.strokePath();\r\n}\t\r\n\r\nfunction addAttack(x, y, angle, damage) {\r\n    var attack = ATTACK_GROUP.get();\r\n    if (attack)\r\n    {\r\n        attack.fire(x, y, angle, damage);\r\n    }\r\n}\r\n\r\n//---------------------------------------------------------CLASSES--------------------------------------------\r\nclass HealthBar {\r\n\r\n    constructor(scene, x, y) {\r\n        this.bar = new Phaser.GameObjects.Graphics(scene);\r\n\r\n        this.x = x;\r\n        this.y = y;\r\n        this.value = ENEMY_HP;\r\n        this.p = .076;\r\n\r\n        this.draw();\r\n\r\n        mainGame.add.existing(this.bar);\r\n    }\r\n\r\n    setPosition(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.draw();\r\n    }\r\n\r\n    decrease(amount) {\r\n        this.value -= amount;\r\n\r\n        if (this.value < 0) {\r\n            this.value = 0;\r\n        }\r\n\r\n        this.draw();\r\n\r\n        return (this.value === 0);\r\n    }\r\n\r\n    draw() {\r\n        this.bar.clear();\r\n\r\n        //  BG\r\n        this.bar.fillStyle(0x000000);\r\n        this.bar.fillRect(this.x, this.y, 80, 16);\r\n\r\n        //  Health\r\n\r\n        this.bar.fillStyle(0xffffff);\r\n        this.bar.fillRect(this.x + 2, this.y + 2, 76, 12);\r\n\r\n        if (this.value < 0.6 * ENEMY_HP) {\r\n            this.bar.fillStyle(0xff0000);\r\n        }\r\n        else if (this.value < 0.3 * ENEMY_HP)\r\n            this.bar.fillStyle(0x00ffff);\r\n        else {\r\n            this.bar.fillStyle(0x00ff00);\r\n        }\r\n\r\n        var d = Math.floor(this.p * this.value);\r\n\r\n        this.bar.fillRect(this.x + 2, this.y + 2, d, 12);\r\n    }\r\n\r\n    destroy() {\r\n        this.bar.destroy();\r\n    }\r\n\r\n}\r\n\r\n\r\nclass Enemy extends Phaser.GameObjects.Sprite {\r\n\r\n    constructor (scene)\r\n    {\r\n        super(scene);\r\n        //dknight.animations.add('walk_down', 1, 4);\r\n        //this.anims.create({ key: 'down', frames: this.anims.generateFrameNames('deathknight', { prefix: 'walk_down_', start: 1, end: 4 }), frameRate: 5, repeat: -1 })\r\n        \r\n\t\tvar enemy = Phaser.GameObjects.Sprite.call(this, scene, 0, 0, 'deathknight');\r\n\t\t\r\n\t\t\r\n        \r\n        this.anims.play('dkdown');\r\n        //walk.play();\r\n        this.follower = { t: 0, vec: new Phaser.Math.Vector2() };\r\n        this.hp = 0;\r\n        this.turned = 0;\r\n\t\t\r\n\t\tthis.text = mainGame.add.text(0, 0, \"HP: \"+ ENEMY_HP, {font: \"16px Arial\", fill: \"#ffffff\"});\r\n\t\tthis.text.setPadding(0, 0, 0, 60);\r\n\t\tthis.text.setOrigin(0.5);\r\n\t\tthis.healthbar = new HealthBar(scene, 0, 0);\r\n\t\t\r\n    }\r\n\r\n\tstartOnPath ()\r\n\t{\r\n\t\tthis.follower.t = 0;\r\n\t\tthis.hp = ENEMY_HP;\r\n\t\t\r\n\t\tpath.getPoint(this.follower.t, this.follower.vec);\r\n\t\t\r\n\t\tthis.setPosition(this.follower.vec.x, this.follower.vec.y);     \r\n\t\tthis.text.setPosition(this.follower.vec.x, this.follower.vec.y);\r\n\t\tthis.healthbar.setPosition(this.follower.vec.x - this.width, this.follower.vec.y - this.height);\r\n\t }\r\n\t\r\n\treceiveDamage(damage) {\r\n\t\tthis.hp -= damage;           \r\n\t\tthis.text.setText(\"HP: \" + this.hp);\r\n\t\tthis.healthbar.decrease(damage);\r\n\t\t// if hp drops below 0 we deactivate this enemy\r\n\t\tif (this.hp <= 0) {\r\n\t\t\tthis.setActive(false);\r\n\t\t\tthis.setVisible(false);\r\n\t\t\tthis.text.setActive(false);\r\n\t\t\tthis.text.setVisible(false);\r\n\t\t\tthis.healthbar.destroy();\r\n\t\t\t//dkdeath.play();\r\n\t\t\t//Need to set this to stop when all enemies are dead\r\n\t\t\t//walk.stop();\r\n\t\t\tthis.destroy();\r\n\t\t}\r\n\t}\r\n\t\r\n\tupdate (time, delta)\r\n\t{\r\n\t\t//ENEMY_SPEED = 1/Math.floor((Math.random() * (10000 - 5000)) + 5000);\r\n\t\tthis.follower.t += ENEMY_SPEED * delta;\r\n\t\t\r\n\t\tpath.getPoint(this.follower.t, this.follower.vec);\r\n\t\t\r\n\t\tthis.setPosition(this.follower.vec.x, this.follower.vec.y);\r\n\t\tthis.text.setPosition(this.follower.vec.x, this.follower.vec.y);\r\n\t\tthis.healthbar.setPosition(this.follower.vec.x - this.width, this.follower.vec.y - this.height);\r\n\t\tif (this.follower.vec.y == 164 && this.turned == 0) {\r\n\t\t\tthis.anims.play('dkright');\r\n\t\t\tthis.turned = 1;\r\n\t\t}\r\n\t\telse if (this.follower.vec.y != 164 && this.turned == 1)\r\n\t\t{\r\n\t\t\tthis.anims.play('dkdown');\r\n\t\t\tthis.turned = 2;\r\n\t\t}\r\n\r\n\t\tif (this.follower.t >= 1)\r\n\t\t{\r\n\t\t\tthis.setActive(false);\r\n\t\t\tthis.setVisible(false);\r\n\t\t\tthis.text.setActive(false);\r\n\t\t\tthis.text.setVisible(false);\r\n\t\t\tthis.healthbar.destroy();\r\n\t\t\tthis.destroy();\r\n\t\t}\r\n\t}\r\n};\r\n\r\n//towers class\r\nclass Tower extends Phaser.GameObjects.Image {\r\n\r\n\tconstructor (scene, stats)\r\n\t{\r\n\t\tsuper(scene);\r\n\t\tthis.nextTic = 0;\r\n\t\tthis.towerId =  stats.towerId; //each tower has unique id\r\n\t\tthis.towerName = stats.towerName;\r\n\t\tthis.upgrade = stats.upgrade; //true = can upgrade, false = can't upgrade\r\n\t\tthis.str = stats.str; //value that determines attack strength\r\n\t\tthis.atkRange = stats.atkRange;\r\n\t\tthis.atkType = stats.atkType;\r\n\t\tthis.atkRate = stats.atkRate; \r\n\t\tthis.hitFly = stats.hitFly; //true = can hit flying enemeies, false = cannot hit flying enemies\r\n\t\t//this.aoeRange = aoeRange; //area of effect range\r\n\t\t//this.spc = spc; //has special attack, each value represents special type, 0 = none, 1 = chance to stun, etc.\r\n\t\tthis.text = mainGame.add.text(0, 0, this.towerName, {font: \"16px Arial\", fill: \"#ffffff\"});\r\n\t}\r\n\t\r\n\tplaceTower(pointer) {\r\n\t\tvar i = Math.floor(pointer.y/64);\r\n\t\tvar j = Math.floor(pointer.x/64);\r\n\t\tif(map[i][j] === 0) {\r\n\t\t\t//console.log(tower);\r\n\t\t\tif (this)\r\n\t\t\t{\r\n\t\t\t\tthis.text.y = (i+.50) * 64 + 64/2;\r\n\t\t\t\tthis.text.x = j * 64 + 64/2;\r\n\t\t\t\tthis.text.setOrigin(0.5);\r\n\t\t\t\t//mainGame.add.container([this.text, this]);\r\n\t\t\t\tthis.setActive(true);\r\n\t\t\t\tthis.setVisible(true);\r\n\t\t\t\tthis.y = i * 64 + 64/2;\r\n\t\t\t\tthis.x = j * 64 + 64/2;\r\n\t\t\t\t//map[i][j] = 1;\r\n\t\t\t\tmap[i][j] = this;\r\n\t\t\t}   \r\n\t\t\t//console.log(TOWER_GROUP.getTotalUsed());\r\n\t\t\t//console.log(TOWER_GROUP.getLength());\r\n\t\t}\r\n\t\telse\r\n\t\t\tTOWER_GROUP[this.towerId].remove(this, true, true);\t\t//tower is created before it's placed so removed if the place clicked on is  not avaialble\r\n\t}\r\n\r\n\tremoveTower(pointer) {\r\n\t\tvar i = Math.floor(pointer.y/64);\r\n\t\tvar j = Math.floor(pointer.x/64);\r\n\t\tif(map[i][j] !== 0) {\r\n\t\t\tthis.setActive(false);\r\n\t\t\tthis.setVisible(false);\r\n\t\t\tthis.text.setActive(false);\r\n\t\t\tthis.text.setVisible(false);\r\n\t\t\tmap[i][j] = 0;\t\t\t\t\t\t\t\t//remove from map\r\n\t\t\tTOWER_GROUP[this.towerId].remove(this, true, true);\t\t\t//removes from group, if want to keep it as inactive then remove this line\r\n\t\t}\r\n\t\t\t\r\n\t}\r\n\t\r\n\tupgradeTower(pointer, newTower) {\r\n\t\tvar i = Math.floor(pointer.y/64);\r\n\t\tvar j = Math.floor(pointer.x/64);\r\n\t\tthis.removeTower(pointer);\r\n\t\tnewTower.placeTower(pointer);\r\n\t\t//console.log(TOWER_GROUP.getTotalUsed());\r\n\t\t//console.log(TOWER_GROUP.getLength());\r\n\t\r\n\t}\r\n\t\r\n\tfire() {\r\n\t\tvar enemy = getEnemy(this.x, this.y, this.atkRange);\r\n\t\tif(enemy) {\r\n\t\t\tvar angle = Phaser.Math.Angle.Between(this.x, this.y, enemy.x, enemy.y);\r\n\t\t\taddAttack(this.x, this.y, angle, this.str);\r\n\t\t\t//this.angle = (angle + Math.PI/2) * Phaser.Math.RAD_TO_DEG;    //uncomment to make towers rotate to face enemy\r\n\t\t}\r\n\t}\r\n\t\r\n\tupdate(time, delta, pointer)\r\n\t{\r\n\t\tif(time > this.nextTic) {\r\n\t\t\tthis.fire();\r\n\t\t\tthis.nextTic = time + this.atkRate;\r\n\t\t}\r\n\t}\r\n\t\r\n\tsayName()\r\n\t{\r\n\t\tconsole.log(this.towerName);\r\n\t}\r\n\r\n};\r\n\r\nclass Peasant extends Tower {\r\n\tconstructor(scene, stats) {\r\n\t\t// Note: In derived classes, super() must be called before you\r\n\t\t// can use 'this'. Leaving this out will cause a reference error.\r\n\t\tsuper(scene, stats);\r\n\t\tPhaser.GameObjects.Image.call(this, scene, 0, 0, 'peasant', 'sprite35');\r\n\t}\r\n\tpFn()\r\n\t{\r\n\t\tconsole.log(this.towerName);\r\n\t}\r\n\r\n}\r\n\r\nclass Soldier extends Tower {\r\n\tconstructor(scene, stats) {\r\n\t\tsuper(scene, stats);\r\n\t\tPhaser.GameObjects.Image.call(this, scene, 0, 0, 'goldenarmor', 'sprite25');\r\n\t\t\r\n\t}\r\n\tsFn()\r\n\t{\r\n\t\tconsole.log(this.towerName);\r\n\t}\r\n\r\n}\r\n\r\nclass Archer extends Tower {\r\n\tconstructor(scene, stats) {\r\n\t\tsuper(scene, stats);\r\n\t\tPhaser.GameObjects.Image.call(this, scene, 0, 0, 'archer', 'tile051');\r\n\t\t\r\n\t}\r\n\taFn()\r\n\t{\r\n\t\tconsole.log(this.towerName);\r\n\t}\r\n\r\n}\r\n\r\n//the yellow thing the towers shoots at enemy, can be any form of projectile\r\nclass Attack extends Phaser.GameObjects.Image {\r\n\tconstructor(scene)\r\n\t{\r\n\t\tsuper(scene);\r\n\t\tPhaser.GameObjects.Image.call(this, scene, 0, 0, 'attack');\r\n\r\n\t\tthis.incX = 0;\r\n\t\tthis.incY = 0;\r\n\t\tthis.lifespan = 0;\r\n\t\tthis.damage = 0;\r\n\r\n\t\tthis.speed = Phaser.Math.GetSpeed(600, 1);\r\n\t}\r\n\r\n\tfire(x, y, angle, damage)\r\n\t{\r\n\t\tthis.setActive(true);\r\n\t\tthis.setVisible(true);\r\n\t\t//  Attacks fire from the middle of the screen to the given x/y\r\n\t\tthis.setPosition(x, y);\r\n\t\t\r\n\t//  we don't need to rotate the attacks as they are round\r\n\t//    this.setRotation(angle);\r\n\r\n\t\tthis.dx = Math.cos(angle);\r\n\t\tthis.dy = Math.sin(angle);\r\n\r\n\t\tthis.lifespan = 1000;\r\n\t\tthis.damage = damage;\r\n\t}\r\n\r\n\tupdate (time, delta)\r\n\t{\r\n\t\tthis.lifespan -= delta;\r\n\r\n\t\tthis.x += this.dx * (this.speed * delta);\r\n\t\tthis.y += this.dy * (this.speed * delta);\r\n\r\n\t\tif (this.lifespan <= 0)\r\n\t\t{\r\n\t\t\tthis.setActive(false);\r\n\t\t\tthis.setVisible(false);\r\n\t\t}\r\n\t}\r\n\r\n};\r\n\r\n\r\n//----------------------------------------------------GAME-------------------------------------------\t\r\n\t\r\n//Preload function loads assets before game starts\r\nfunction preload() {    \r\n    this.load.atlas('deathknight', 'assets/deathknight.png', 'assets/deathknight.json');\r\n    this.load.atlas('goldenarmor', 'assets/goldenarmor.png', 'assets/goldenarmor.json');\r\n\tthis.load.atlas('archer', 'assets/archer.png', 'assets/archer.json');\r\n    this.load.atlas('peasant', 'assets/peasant.png', 'assets/peasant.json');\r\n\tthis.load.spritesheet('bard', 'assets/bard.png', { frameWidth: 52, frameHeight: 75});\r\n\tthis.load.image('attack', 'assets/coin.png');\r\n\tthis.load.image('map', 'assets/castle-gates.png', { frameWidth: 640, frameHeight: 512 });\r\n\tthis.load.audio('dkDeath', 'assets/Sounds/Death Screams/Human/sfx_deathscream_human5.wav');\r\n\tthis.load.audio('hit', 'assets/Sounds/General Sounds/Simple Damage Sounds/sfx_damage_hit2.wav');\r\n\tthis.load.audio('walk', 'assets/Sounds/Movement/Footsteps/sfx_movement_footstepsloop4_slow.wav');\r\n\tthis.load.audio('background', 'assets/Sounds/random silly chip song.ogg');\r\n\r\n}\r\n \r\n//create function initializes and adds assets to game\r\nfunction create() {\r\n\t//path to which enemey follows\r\n    var graphics = this.add.graphics();    \r\n    drawLines(graphics);\r\n    path = this.add.path(96, -32);\r\n    path.lineTo(96, 164);\r\n    path.lineTo(480, 164);\r\n    path.lineTo(480, 544);\r\n\t\r\n    graphics.lineStyle(0, 0xffffff, 1);\r\n    path.draw(graphics);\r\n    \r\n    this.add.image(320, 256, 'map');\r\n\r\n    mainGame = this;\r\n\r\n    mainGame.anims.create({\r\n        key: 'dkdown',\r\n        frames: mainGame.anims.generateFrameNames('deathknight', { prefix: 'walk_down_', start: 1, end: 4 }),\r\n        frameRate: 3,\r\n        repeat: -1\r\n    });\r\n    mainGame.anims.create({\r\n        key: 'dkright',\r\n        frames: mainGame.anims.generateFrameNames('deathknight', { prefix: 'walk_right_', start: 1, end: 4 }),\r\n        frameRate: 5,\r\n        repeat: -1\r\n    });\t\r\n\r\n/*     dkdeath = this.sound.add('dkDeath');\r\n    damage = this.sound.add('hit');\r\n    damage.volume = 0.3;\r\n    walk = this.sound.add('walk');\r\n    walk.volume = 0.3;\r\n    walk.loop = true;\r\n    background = this.sound.add('background');\r\n    background.volume = 0.2;\r\n    background.loop = true;\r\n    background.play(); */\r\n\t\r\n\t//creates a group for a tower type, that way we can use TOWER_GROUP.get(peasantStats) to instantiate new towers easily\r\n    //same goes for enemies and attacks and for any new classes created\r\n\tTOWER_GROUP[peasantStats.towerId] = this.add.group({ classType: Peasant, runChildUpdate: true });\r\n\tTOWER_GROUP[soldierStats.towerId] = this.add.group({ classType: Soldier, runChildUpdate: true });\r\n\tTOWER_GROUP[archerStats.towerId] = this.add.group({ classType: Archer, runChildUpdate: true });\r\n\t//TOWER_GROUP[apprenticeStats.towerId] = this.add.group({ classType: Apprentice, runChildUpdate: true });\r\n\r\n\t\r\n\tENEMY_GROUP = this.physics.add.group({ classType: Enemy, runChildUpdate: true }); //key: 'walk_down_', frame: [1, 2, 3, 4], repeat: 5, active: true });\r\n   \r\n\t\r\n    //ENEMY_GROUP.callAll('play', null, 'down',);\r\n\r\n    ATTACK_GROUP = this.physics.add.group({ classType: Attack, runChildUpdate: true });\r\n    \r\n    this.nextEnemy = 0;\r\n    \r\n    this.physics.add.overlap(ENEMY_GROUP, ATTACK_GROUP, damageEnemy);\r\n    \r\n\tthis.input.mouse.disableContextMenu();\r\n\t\r\n    this.input.on('pointerdown', function (pointer) {\r\n\t\tif (pointer.leftButtonDown())\r\n        {\r\n\t\t\tvar i = Math.floor(pointer.y/64);\r\n\t\t\tvar j = Math.floor(pointer.x/64);\r\n\t\t\tif(map[i][j] == 0)\r\n\t\t\t{\r\n\t\t\t\tvar tower = TOWER_GROUP[peasantStats.towerId].get(peasantStats);\r\n\t\t\t\ttower.placeTower(pointer);\r\n\t\t\t}\r\n\t\t\telse if(map[i][j].towerId == 0)\r\n\t\t\t{\r\n\t\t\t\tvar tower = map[i][j];\r\n\t\t\t\t//var newTG = mainGame.add.group({ classType: Soldier, runChildUpdate: true });\r\n\t\t\t\tvar newTower = TOWER_GROUP[soldierStats.towerId].get(soldierStats);\r\n\t\t\t\ttower.upgradeTower(pointer, newTower);\r\n\t\t\t\ttower.setText = newTower.towerName;\r\n\t\t\t}\r\n\t\t\telse if(map[i][j].towerId == 1)\r\n\t\t\t{\r\n\t\t\t\tvar tower = map[i][j];\r\n\t\t\t\t//var newTG = mainGame.add.group({ classType: Soldier, runChildUpdate: true });\r\n\t\t\t\tvar newTower = TOWER_GROUP[archerStats.towerId].get(archerStats);\r\n\t\t\t\ttower.upgradeTower(pointer, newTower);\r\n\t\t\t\ttower.setText = newTower.towerName;\r\n\t\t\t}\r\n        }\r\n        else if (pointer.rightButtonDown())\r\n        {\r\n\t\t\tvar i = Math.floor(pointer.y/64);\r\n\t\t\tvar j = Math.floor(pointer.x/64);\r\n\t\t\tvar tower = map[i][j];\r\n\t\t\tif(typeof tower === \"object\")\r\n\t\t\t{\r\n\t\t\t\ttower.removeTower(pointer);\r\n\t\t\t}\r\n        }\r\n\t\telse if (pointer.middleButtonDown())\r\n\t\t{\r\n\t\t\t\r\n\t\t}\r\n\t});\r\n\t\r\n/* \tthis.arrow = this.input.keyboard.createCursorKeys();\r\n\tif (this.arrow.down.isDown) {\r\n\t   this.scene.pause();\r\n\t}  */\r\n}\r\n\r\n\r\n"]}